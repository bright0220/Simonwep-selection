!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Selection=t():e.Selection=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.on=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s(e,t,n,o,"addEventListener"),arguments},t.off=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s(e,t,n,o,"removeEventListener"),arguments},t.bindClassUnderscoreFunctions=function(e){var t=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),n=!0,o=!1,r=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;"_"===s.charAt(0)&&"function"==typeof e[s]&&(e[s]=e[s].bind(e))}}catch(e){o=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}},t.css=function(e,t,n){var r=e&&e.style;if(r)if("object"===(void 0===t?"undefined":o(t))){var i=Object.getOwnPropertyNames(t),s=!0,l=!1,c=void 0;try{for(var u,f=i[Symbol.iterator]();!(s=(u=f.next()).done);s=!0){var h=u.value,d=t[h];r[h]=d+("string"==typeof d?"":"px")}}catch(e){l=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw c}}}else{if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,null):e.currentStyle&&(n=e.currentStyle),void 0===prop?n:n[t];if(t in r)r[t]=n+("string"==typeof n?"":"px");else{var v=!0,p=!1,m=void 0;try{for(var y,_=a[Symbol.iterator]();!(v=(y=_.next()).done);v=!0){var b=y.value;r[b+t]=n+("string"==typeof n?"":"px")}}catch(e){p=!0,m=e}finally{try{!v&&_.return&&_.return()}finally{if(p)throw m}}}}},t.intersects=function(e,t){var n=e.getBoundingClientRect(),o=t.getBoundingClientRect();return n.left+n.width>=o.left&&n.left<=o.left+o.width&&n.top+n.height>=o.top&&n.top<=o.top+o.height},t.selectAll=function(e){Array.isArray(e)||(e=[e]);var t=[],n=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;t.push.apply(t,i(document.querySelectorAll(l)))}}catch(e){o=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}return t},t.eventPath=function(e){var t=e.path||e.composedPath&&e.composedPath();if(t)return t;var n=e.target.parentElement;for(t=[e.target];n;n=n.parentElement)t.push(n);return t.push(document,window),t},t.removeElement=function(e,t){var n=e.indexOf(t);~n&&e.splice(n,1)},t.createElement=function(e,t){var n=document.createElement(e);t instanceof HTMLElement&&t.appendChild(n);return n};var a=["-moz-","-ms-","-o-","-webkit-"];function s(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments[4];HTMLCollection.prototype.isPrototypeOf(e)||NodeList.prototype.isPrototypeOf(e)?e=Array.from(e):Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);var a=!0,s=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var f=c.value,h=!0,d=!1,v=void 0;try{for(var p,m=t[Symbol.iterator]();!(h=(p=m.next()).done);h=!0){var y=p.value;f[i](y,n,r({capture:!1},o))}}catch(e){d=!0,v=e}finally{try{!h&&m.return&&m.return()}finally{if(d)throw v}}}}catch(e){s=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(s)throw l}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchFilterEvent=function(e,t,n){var o=e.options[t];if("function"==typeof o){var r={selection:e,eventName:t,element:n};return o.call(e,r)}},t.dispatchEvent=function(e,t,n,o,r,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=e.options[t];if("function"==typeof s){var l={selection:e,eventName:t,areaElement:n,selectedElements:r,changedElements:i,originalEvent:o};for(var c in a)l[c]=a[c];return s.call(e,l)}}},function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=a(n(1)),i=a(n(0));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var s=Math.abs,l=Math.max,c=Math.min,u=function(e){return e.preventDefault()},f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=Object.assign({class:"selection-area",startThreshold:10,singleClick:!0,disableTouch:!1,containers:[],selectables:[],startareas:["html"],boundaries:["html"]},t),i.bindClassUnderscoreFunctions(this),this._selectedStore=[],this.areaElement=i.createElement("div",document.body),i.css(this.areaElement,{top:0,left:0,position:"fixed"}),i.on(document,"mousedown",this._onTapStart),this.options.disableTouch||i.on(document,"touchstart",this._onTapStart,{passive:!1})}return o(e,[{key:"_onTapStart",value:function(e){var t=this,n=e.touches&&e.touches[0],o=(n||e).target,r=i.selectAll(this.options.startareas);this._boundaries=i.selectAll(this.options.boundaries);var a=i.eventPath(e);if(r.find(function(e){return a.includes(e)})&&this._boundaries.find(function(e){return a.includes(e)})){this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,this._singleClick=!0;var s=i.selectAll(this.options.containers);this._selectables=i.selectAll(this.options.selectables),s.forEach(function(e){var n;return(n=t._selectables).push.apply(n,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.getElementsByTagName("*")))}),this._targetBoundary=this._boundaries.find(function(e){return i.intersects(e,o)}).getBoundingClientRect(),this._touchedElements=[],this._changedElements={added:[],removed:[]},this.areaElement.classList.add(this.options.class),i.on(document,"selectstart",u),i.on(document,"mousemove",this._delayedTapMove),i.on(document,"touchmove",this._delayedTapMove,{passive:!1}),i.on(document,["mouseup","touchcancel","touchend"],this._onTapStop),e.preventDefault()}}},{key:"_onSingleTap",value:function(e){var t=(e.touches&&e.touches[0]||e).target;if(this._selectables.includes(t)){this._touchedElements.push(t);var n=this._selectedStore,o=this._changedElements;r.dispatchEvent(this,"onSelect",this.areaElement,e,n,o,{target:t})}}},{key:"_delayedTapMove",value:function(e){var t=e.touches&&e.touches[0],n=(t||e).clientX,o=(t||e).clientY;if(s(n+o-(this._lastX+this._lastY))>=this.options.startThreshold){i.off(document,["mousemove","touchmove"],this._delayedTapMove),i.on(document,["mousemove","touchmove"],this._onTapMove),i.css(this.areaElement,"display","block"),this._updateArea(e);var a=this._touchedElements.concat(this._selectedStore),l=this._changedElements;r.dispatchEvent(this,"onStart",this.areaElement,e,a,l),this._singleClick=!1}}},{key:"_onTapMove",value:function(e){this._updateArea(e),this._updatedTouchingElements();var t=this._touchedElements.concat(this._selectedStore),n=this._changedElements;r.dispatchEvent(this,"onMove",this.areaElement,e,t,n)}},{key:"_updateArea",value:function(e){var t=this._targetBoundary,n=e.touches&&e.touches[0],o=(n||e).clientX,r=(n||e).clientY;o<t.left&&(o=t.left),r<t.top&&(r=t.top),o>t.left+t.width&&(o=t.left+t.width),r>t.top+t.height&&(r=t.top+t.height);var a=c(this._lastX,o),s=c(this._lastY,r),u=l(this._lastX,o),f=l(this._lastY,r);i.css(this.areaElement,{top:s,left:a,width:u-a,height:f-s})}},{key:"_onTapStop",value:function(e,t){if(i.off(document,["mousemove","touchmove"],this._delayedTapMove),i.off(document,["touchmove","mousemove"],this._onTapMove),i.off(document,["mouseup","touchcancel","touchend"],this._onTapStop),this._singleClick)this._onSingleTap(e);else if(!t){this._updatedTouchingElements();var n=this._touchedElements.concat(this._selectedStore),o=this._changedElements;r.dispatchEvent(this,"onStop",this.areaElement,e,n,o)}i.off(document,"selectstart",u),i.css(this.areaElement,"display","none")}},{key:"_updatedTouchingElements",value:function(){var e=this,t=[],n={added:[],removed:[]};this._selectables.forEach(function(o){!1!==r.dispatchFilterEvent(e,"selectionFilter",o)&&i.intersects(e.areaElement,o)&&(e._touchedElements.includes(o)||n.added.push(o),t.push(o))}),n.removed=this._touchedElements.filter(function(e){return!t.includes(e)}),this._touchedElements=t,this._changedElements=n}},{key:"keepSelection",value:function(){var e=this,t=this._touchedElements.filter(function(t){return!e._selectedStore.includes(t)});this._selectedStore=t.concat(this._selectedStore)}},{key:"clearSelection",value:function(){this._selectedStore=[]}},{key:"removeFromSelection",value:function(e){i.removeElement(this._selectedStore,e),i.removeElement(this._touchedElements,e)}},{key:"cancel",value:function(e){this._onTapStop(null,!e)}},{key:"option",value:function(e,t){var n=this.options;return void 0===t?n[e]:n[e]=t}},{key:"disable",value:function(){i.off(document,"mousedown",this._onTapStart)}},{key:"enable",value:function(){i.on(document,"mousedown",this._onTapStart)}}]),e}();f.utils={on:i.on,off:i.off,css:i.css,intersects:i.intersects,selectAll:i.selectAll,eventPath:i.eventPath,removeElement:i.removeElement},f.create=function(e){return new f(e)},f.version="0.0.11",e.exports=f}])});