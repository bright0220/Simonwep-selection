!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Selection=t():e.Selection=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.bindClassUnderscoreFunctions=function(e){var t=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),n=!0,o=!1,r=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;"_"===s.charAt(0)&&"function"==typeof e[s]&&(e[s]=e[s].bind(e))}}catch(e){o=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}},t.css=function(e,t,n){var r=e&&e.style;if(!r)return;if("object"===(void 0===t?"undefined":o(t)))for(var i in t){var s=t[i];r[i]=l(s)}else{if(null==n){var c=document.defaultView;return c&&c.getComputedStyle?n=c.getComputedStyle(e,null):e.currentStyle&&(n=e.currentStyle),null==t?n:n[t]}if(t in r)r[t]=l(n);else{var u=!0,h=!1,f=void 0;try{for(var d,p=a[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var v=d.value;r[v+t]=l(n)}}catch(e){h=!0,f=e}finally{try{!u&&p.return&&p.return()}finally{if(h)throw f}}}}},t.intersects=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"touch",o=e.getBoundingClientRect(),r=t.getBoundingClientRect();if("center"===n){var i=r.left+r.width/2,a=r.top+r.height/2;return i>=o.left&&i<=o.left+o.width&&a>=o.top&&a<=o.top+o.height}if("cover"===n)return r.left>=o.left&&r.top>=o.top&&r.left+r.width<=o.left+o.width&&r.top+r.height<=o.top+o.height;if("touch"===n)return o.left+o.width>=r.left&&o.left<=r.left+r.width&&o.top+o.height>=r.top&&o.top<=r.top+r.height},t.selectAll=function(e){Array.isArray(e)||(e=[e]);var t=[],n=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;t.push.apply(t,i(document.querySelectorAll(l)))}}catch(e){o=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}return t},t.eventPath=function(e){var t=e.path||e.composedPath&&e.composedPath();if(t)return t;var n=e.target.parentElement;t=[e.target,n];for(;n=n.parentElement;)t.push(n);return t.push(document,window),t},t.removeElement=function(e,t){var n=e.indexOf(t);~n&&e.splice(n,1)},t.createElement=function(e,t){var n=document.createElement(e);t instanceof Element&&t.appendChild(n);return n};var a="moz ms o webkit".split(" ");function s(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t instanceof HTMLCollection||t instanceof NodeList?t=Array.from(t):Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);var a=!0,s=!1,l=void 0;try{for(var c,u=t[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var h=c.value,f=!0,d=!1,p=void 0;try{for(var v,m=n[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var y=v.value;h[e](y,o,r({capture:!1},i))}}catch(e){d=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(d)throw p}}}}catch(e){s=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(s)throw l}}return Array.prototype.slice.call(arguments,1)}t.on=s.bind(null,"addEventListener"),t.off=s.bind(null,"removeEventListener");var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";return"number"==typeof e?e+t:""+e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.dispatchFilterEvent=function(e,t,n){var o=e.options[t];if("function"!=typeof o)return;return o.call(e,{selection:e,eventName:t,element:n})},t.dispatchEvent=function(e,t,n,r,i,a,s){var l=e.options[t];if("function"!=typeof l)return;return l.call(e,o({selection:e,eventName:t,areaElement:n,selectedElements:i,changedElements:a,originalEvent:r},s))}},function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=a(n(1)),i=a(n(0));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var s=Math.abs,l=Math.max,c=Math.min,u=document,h=function(e){return e.preventDefault()},f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=Object.assign({class:"selection-area",mode:"touch",startThreshold:10,singleClick:!0,disableTouch:!1,containers:[],selectables:[],startareas:["html"],boundaries:["html"]},t),i.bindClassUnderscoreFunctions(this),this._selectedStore=[],this.areaElement=i.createElement("div",u.body),i.css(this.areaElement,{top:0,left:0,position:"fixed"}),i.on(u,"mousedown",this._onTapStart),this.options.disableTouch||i.on(u,"touchstart",this._onTapStart,{passive:!1})}return o(e,[{key:"_onTapStart",value:function(e){var t=this,n=e.touches&&e.touches[0],o=(n||e).target,r=i.selectAll(this.options.startareas);this._boundaries=i.selectAll(this.options.boundaries);var a=i.eventPath(e);if(r.find(function(e){return a.includes(e)})&&this._boundaries.find(function(e){return a.includes(e)})){this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,this._singleClick=!0;var s=i.selectAll(this.options.containers);this._selectables=i.selectAll(this.options.selectables),s.forEach(function(e){var n;return(n=t._selectables).push.apply(n,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.getElementsByTagName("*")))}),this._targetBoundary=this._boundaries.find(function(e){return i.intersects(e,o)}).getBoundingClientRect(),this._touchedElements=[],this._changedElements={added:[],removed:[]},this.areaElement.classList.add(this.options.class),i.on(u,"selectstart",h),i.on(u,"mousemove",this._delayedTapMove),i.on(u,"touchmove",this._delayedTapMove,{passive:!1}),i.on(u,["mouseup","touchcancel","touchend"],this._onTapStop),e.preventDefault()}}},{key:"_onSingleTap",value:function(e){var t=(e.touches&&e.touches[0]||e).target;if(this._selectables.includes(t)){this._touchedElements.push(t);var n=this._selectedStore,o=this._changedElements;r.dispatchEvent(this,"onSelect",this.areaElement,e,n,o,{target:t})}}},{key:"_delayedTapMove",value:function(e){var t=e.touches&&e.touches[0],n=(t||e).clientX,o=(t||e).clientY;if(s(n+o-(this._lastX+this._lastY))>=this.options.startThreshold){i.off(u,["mousemove","touchmove"],this._delayedTapMove),i.on(u,["mousemove","touchmove"],this._onTapMove),i.css(this.areaElement,"display","block"),this._updateArea(e);var a=this._touchedElements.concat(this._selectedStore),l=this._changedElements;r.dispatchEvent(this,"onStart",this.areaElement,e,a,l),this._singleClick=!1}}},{key:"_onTapMove",value:function(e){this._updateArea(e),this._updatedTouchingElements();var t=this._touchedElements.concat(this._selectedStore),n=this._changedElements;r.dispatchEvent(this,"onMove",this.areaElement,e,t,n)}},{key:"_updateArea",value:function(e){var t=this._targetBoundary,n=e.touches&&e.touches[0],o=(n||e).clientX,r=(n||e).clientY;o<t.left&&(o=t.left),r<t.top&&(r=t.top),o>t.left+t.width&&(o=t.left+t.width),r>t.top+t.height&&(r=t.top+t.height);var a=c(this._lastX,o),s=c(this._lastY,r),u=l(this._lastX,o),h=l(this._lastY,r);i.css(this.areaElement,{top:s,left:a,width:u-a,height:h-s})}},{key:"_onTapStop",value:function(e,t){if(i.off(u,["mousemove","touchmove"],this._delayedTapMove),i.off(u,["touchmove","mousemove"],this._onTapMove),i.off(u,["mouseup","touchcancel","touchend"],this._onTapStop),this._singleClick)this._onSingleTap(e);else if(!t){this._updatedTouchingElements();var n=this._touchedElements.concat(this._selectedStore),o=this._changedElements;r.dispatchEvent(this,"onStop",this.areaElement,e,n,o)}i.off(u,"selectstart",h),i.css(this.areaElement,"display","none")}},{key:"_updatedTouchingElements",value:function(){for(var e=[],t={added:[],removed:[]},n=0,o=this._selectables.length;n<o;n++){var a=this._selectables[n];i.intersects(this.areaElement,a,this.options.mode)&&!1!==r.dispatchFilterEvent(this,"selectionFilter",a)&&(this._touchedElements.includes(a)||t.added.push(a),e.push(a))}t.removed=this._touchedElements.filter(function(t){return!e.includes(t)}),this._touchedElements=e,this._changedElements=t}},{key:"keepSelection",value:function(){var e=this,t=this._touchedElements.filter(function(t){return!e._selectedStore.includes(t)});this._selectedStore=t.concat(this._selectedStore)}},{key:"clearSelection",value:function(){this._selectedStore=[]}},{key:"removeFromSelection",value:function(e){i.removeElement(this._selectedStore,e),i.removeElement(this._touchedElements,e)}},{key:"cancel",value:function(e){this._onTapStop(null,!e)}},{key:"option",value:function(e,t){var n=this.options;return null==t?n[e]:n[e]=t}},{key:"disable",value:function(){i.off(u,"mousedown",this._onTapStart)}},{key:"enable",value:function(){i.on(u,"mousedown",this._onTapStart)}}]),e}();f.utils={on:i.on,off:i.off,css:i.css,intersects:i.intersects,selectAll:i.selectAll,eventPath:i.eventPath,removeElement:i.removeElement},f.create=function(e){return new f(e)},f.version="0.1.1",e.exports=f}])});