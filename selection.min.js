/*! Selection 0.0.3 - MIT | git://github.com/Simonwep/Selection.git */

'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}(function(a){'use strict';if('undefined'!=typeof module&&'undefined'!=typeof module.exports)module.exports=a();else if('undefined'!=typeof window&&window.document)window.Selection=a();else throw new Error('selection.js requires a window with a document')})(function(){'use strict';function a(a){this.options=a?a:{};var c={class:'selection-area',startThreshold:0,disableTouch:!1,containers:[],selectables:[],startareas:['html'],boundarys:['html']};for(var e in c)e in a||(a[e]=c[e]);for(var f in this)'_'===f.charAt(0)&&'function'==typeof this[f]&&(this[f]=this[f].bind(this));this.areaElement=function(){var a=document.createElement('div');return document.body.appendChild(a),d(a,{top:0,left:0,position:'fixed'}),a}(),b(document,'mousedown',this._onTapStart),this.options.disableTouch||b(document,'touchstart',this._onTapStart)}function b(a,b,c){a.addEventListener(b,c,k)}function c(a,b,c){a.removeEventListener(b,c,k)}function d(a,b,c){var d=a&&a.style;if(d)if('object'===('undefined'==typeof b?'undefined':_typeof(b))){var n=Object.getOwnPropertyNames(b),o=!0,p=!1,q=void 0;try{for(var e,f=n[Symbol.iterator]();!(o=(e=f.next()).done);o=!0){var r=e.value,s=b[r];d[r]=s+('string'==typeof s?'':'px')}}catch(a){p=!0,q=a}finally{try{!o&&f.return&&f.return()}finally{if(p)throw q}}}else{if(void 0===c)return document.defaultView&&document.defaultView.getComputedStyle?c=document.defaultView.getComputedStyle(a,null):a.currentStyle&&(c=a.currentStyle),void 0===prop?c:c[b];if(!(b in d)){var g=!0,h=!1,i=void 0;try{for(var j,k,m=l[Symbol.iterator]();!(g=(j=m.next()).done);g=!0)k=j.value,d[k+b]=c+('string'==typeof c?'':'px')}catch(a){h=!0,i=a}finally{try{!g&&m.return&&m.return()}finally{if(h)throw i}}}else d[b]=c+('string'==typeof c?'':'px')}}function e(a,b){function c(a){var d=Array.from(a.children),e=!0,f=!1,g=void 0;try{for(var h,i,j=d[Symbol.iterator]();!(e=(h=j.next()).done);e=!0)i=h.value,b(i),c(i,b)}catch(a){f=!0,g=a}finally{try{!e&&j.return&&j.return()}finally{if(f)throw g}}}Array.isArray(a)||(a=[a]),a.forEach(c)}function f(c,d){var e=c.getBoundingClientRect(),a=d.getBoundingClientRect();return e.left+e.width>=a.left&&e.left<=a.left+a.width&&e.top+e.height>=a.top&&e.top<=a.top+a.height}function g(a,b,c){var d=a.options[b];if('function'==typeof d){return d.call(a,{selection:a,eventName:b,element:c})}}function h(a,b,c,d,e,f){var g=a.options[b];if('function'==typeof g){return g.call(a,{selection:a,eventName:b,areaElement:c,selectedElements:e,changedElements:f,originalEvent:d})}}function i(a){Array.isArray(a)||(a=[a]);var b=[],c=!0,d=!1,e=void 0;try{for(var f,g,h=a[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,b.push.apply(b,_toConsumableArray(document.querySelectorAll(g)))}catch(a){d=!0,e=a}finally{try{!c&&h.return&&h.return()}finally{if(d)throw e}}return b}function j(a){var b,c=a.target;for(b=[a.target];c;c=c.parentElement)b.push(c);return b.push(document,window),b}var k=!1,l=['-moz-','-ms-','-o-','-webkit-'],m=Math.abs,n=Math.max,o=Math.min;return a.prototype={constructor:a,_onTapStart:function _onTapStart(a){var c=a.touches&&a.touches[0],d=(c||a).target,e=i(this.options.startareas);this._boundarys=i(this.options.boundarys);var k=j(a);!1!==g(this,'startFilter',d)&&e.find(function(a){return k.includes(a)})&&this._boundarys.find(function(a){return k.includes(a)})&&(this._lastX=(c||a).clientX,this._lastY=(c||a).clientY,this._containers=i(this.options.containers),this._selectables=i(this.options.selectables),this._targetBoundary=this._boundarys.find(function(a){return f(a,d)}),this._touchedElements=[],this._changedElements={added:[],removed:[]},this.areaElement.classList.add(this.options.class),b(document,'mousemove',this._delayedTapMove),b(document,'touchmove',this._delayedTapMove),b(document,'mouseup',this._onTapStop),b(document,'touchcancel',this._onTapStop),b(document,'touchend',this._onTapStop),h(this,'onStart',this.areaElement,a,this._touchedElements,this._changedElements))},_delayedTapMove:function _delayedTapMove(a){var e=a.touches&&a.touches[0],f=(e||a).clientX,g=(e||a).clientY;m(f+g-(this._lastX+this._lastY))>=this.options.startThreshold&&(c(document,'mousemove',this._delayedTapMove),c(document,'touchmove',this._delayedTapMove),b(document,'mousemove',this._onTapMove),b(document,'touchmove',this._onTapMove),d(this.areaElement,'display','block'))},_onTapMove:function _onTapMove(a){var b=this._targetBoundary.getBoundingClientRect(),c=a.touches&&a.touches[0],e=(c||a).clientX,f=(c||a).clientY;e<b.x&&(e=b.x),f<b.top&&(f=b.top),e>b.x+b.width&&(e=b.x+b.width),f>b.top+b.height&&(f=b.top+b.height);var g=o(this._lastX,e),i=o(this._lastY,f),j=n(this._lastX,e),k=n(this._lastY,f);d(this.areaElement,{top:i,left:g,width:j-g,height:k-i}),this._updatedTouchingElements();var l=this._touchedElements,m=this._changedElements;h(this,'onMove',this.areaElement,a,l,m)},_onTapStop:function _onTapStop(a,b){if(d(this.areaElement,'display','none'),c(document,'mousemove',this._delayedTapMove),c(document,'touchmove',this._delayedTapMove),c(document,'mousemove',this._onTapMove),c(document,'touchmove',this._onTapMove),c(document,'mouseup',this._onTapStop),c(document,'touchcancel',this._onTapStop),c(document,'touchend',this._onTapStop),!b){this._updatedTouchingElements();var e=this._touchedElements,f=this._changedElements;h(this,'onStop',this.areaElement,a,e,f)}},_updatedTouchingElements:function _updatedTouchingElements(){var a=this,b=[],c={added:[],removed:[]},d=function(d){!1!==g(a,'selectionFilter',d)&&f(a.areaElement,d)&&(!a._touchedElements.includes(d)&&c.added.push(d),b.push(d))}.bind(this);e(this._containers,d),this._selectables.forEach(d);for(var h,j=this._touchedElements,k=j.length-1;0<=k;k--)h=j[k],b.includes(h)||c.removed.push(h);this._touchedElements=b,this._changedElements=c},cancel:function cancel(a){this._onTapStop(null,!a)},option:function option(a,b){var c=this.options;return void 0===b?c[a]:c[a]=b},disable:function disable(){c(document,'mousedown',this._onTapStart)},enable:function enable(){b(document,'mousedown',this._onTapStart)}},a.utils={on:b,off:c,css:d,intersects:f,traverseNode:e,selectAll:i,eventPath:j},a.create=function(b){return new a(b)},a.version='0.0.3',a});
